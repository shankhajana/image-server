"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getImageHandler = exports.saveImageHandler = void 0;
const save_image_request_1 = __importDefault(require("../dtos/save-image-request"));
const dao_1 = require("../daos/dao");
const web_utils_1 = require("../utilities/web-utils");
const image_1 = __importDefault(require("../entities/image"));
const EMPTY_ID = "";
exports.saveImageHandler = (req, res) => {
    dao_1.saveImage(getImageObjFromRequest(req), (imageId) => {
        res.json(web_utils_1.getResponse(imageId));
    });
};
const getImageObjFromRequest = (req) => {
    const request = new save_image_request_1.default(req.body);
    const uploadInformation = req.file;
    console.log("save image request body: " + JSON.stringify(request));
    console.log("uploadInformation: " + JSON.stringify(uploadInformation));
    const image = new image_1.default(
    /* id will be generated by the DAO layer */
    EMPTY_ID, request.userId, request.title, request.description, uploadInformation.originalname, uploadInformation.filename, uploadInformation.path);
    return image;
};
exports.getImageHandler = (req, res) => {
    const imageId = req.params.id;
    dao_1.getImage(imageId, (image) => {
        res.json(web_utils_1.getResponse(image));
    });
};
//# sourceMappingURL=image-handler.js.map